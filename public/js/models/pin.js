// AM: Props on the OOJS approach. Was able to navigate your code easily.

// AM: I like this model setup. Default lat-lng values if not generated by Geocoder.
// AM: Next step - look into drag-drop and matching pin to cursor?

var Pin = function(info){
  this.id = info.id;
  this.title = info.title;
  this.latitude = info.latitude || 13.5333;
  this.longitude = info.longitude || 2.0833;
  this.userId = info.userId || current_user;
  this.isRed = info.isRed || "t";
  this.description = info.description || "What is on the agenda...";
};

// AM: What does the else clause (var userId = 1) do?
// Guessing your hard-coding a guest user.

Pin.whichUser = function(){
  var request = $.getJSON("/auth/twitter/show")
  .then(function(response){
    if(response.userId){
      var userId = response.userId
    }
    else {
      var userId = 1;
    }
    return userId;
  })
  return request
}

// AM: Opportunity for refactoring. Your `then` block in the above and below functions are identical.

Pin.fetch = function(userId){
  var request = $.getJSON("/auth/twitter/show")
  .then(function(response){
    if(response.userId){
      var userId = response.userId
    }
    else {
      var userId = 1;
    }
    return userId;
  }).then(function(userId){
    var request = $.getJSON("/users/"+userId+"/pins/")
    .then(function(response) {
      var pins = [];
      for(var i = 0; i < response.length; i++){
        pins.push(new Pin(response[i]));
      }
      return pins;
    })
    .fail(function(response){
      console.log("failed to fetch pins from user with id: "+userId);
    });
    return request;
  })
  return request;
}
Pin.show = function(pinId){
  var request = $.getJSON("/pins/"+pinId)
  .then(function(response) {
    return response
  }).fail(function(response){
    console.log("failed to fetch pins with id: "+pinId);
  })
  return request;
}
Pin.getPhotos = function(pinId){
  var request = $.getJSON("/pins/"+pinId+"/photos/")
  .then(function(response) {
    return response
  }).fail(function(response){
    console.log("failed to fetch photos from pin with id: "+pinId);
  })
  return request;
}
